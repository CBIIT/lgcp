library(edgeR)
library(tidyverse)
library(tximport)
file_name <- "/Volumes/sowalskylab-a/SowalskyLab/Capaldo-BX-Project-Management/A3-52-1_star_rsem.genes.results"
txi.rsem <- tximport(file_name, type = "rsem", txIn = FALSE, txOut = FALSE)
head(txi.rsem$counts)
head(txi.rsem$countsFromAbundance)
read_tsv(file_name)
file_name
?fiterByExpr
?filterByExpr
file.path(dir, "rsem", samples$run, paste0(samples$run, ".genes.results.gz"))
dir <- system.file("extdata", package = "tximportData")
dir
list.files(dir)
library(tximport)
system.file("extdata")
BiocManager::install("tximportData")
dir <- system.file("extdata", package = "tximportData")
dir
file_name
dir_name <- dir
file_names <- list.files(path = dir_name,
pattern = ".genes.results$|.genes.results.gz$",
full.names = T,
recursive = T)
txi <- tximport(file_names, type = "rsem", txIn = FALSE, txOut = FALSE)
cts <- txi$counts
normMat <- txi$length
normMat <- normMat/exp(rowMeans(log(normMat)))
o <- log(calcNormFactors(cts/normMat)) + log(colSums(cts/normMat))
cts
is.na(cts)
is.na(cts) %>% table()
txi$length
is.na(normMat) %>% table()
is.na(txi$length)
is.na(txi$length) %>% table()
cts <- txi$counts
normMat <- txi$length
is.na(normMat) %>% table()
is.na(log(normMat)) %>% table()
is.na(rowMeans(log(normMat))) %>% table()
is.na(exp(rowMeans(log(normMat)))) %>% table()
range(exp(rowMeans(log(normMat))))
normMat == 0
normMat[normMat == 0]
normMat[normMat == 1]
normMat[normMat == 2]
normMat[normMat >= 0]
range(normMat[normMat >= 0] )
min(normMat[normMat >= 0] )
min(normMat[normMat > 0] )
table(txi$length == 0 )
txi$abundance
dim(txi$length)
head(txi$length)
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template-github_document.R")
rmarkdown::render("notes/notebook-template-github_document.R")
rmarkdown::render("notes/notebook-template-github_document.R")
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template.R")
rmarkdown::render("notes/notebook-template-github_document.R")
library(DropletUtils)
sce <- read10xCounts("/Volumes/Group05/CCBB/SA/Bioinfo_2018/CS024650_Kelly_Agarwal/02_PrimaryAnalysisOutput/00_FullCellrangerOutput/SCAF604_683/")
